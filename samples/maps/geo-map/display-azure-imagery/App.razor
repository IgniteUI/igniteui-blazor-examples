@using IgniteUI.Blazor.Controls

@inject NavigationManager NavManager

<div class="container horizontal">

    <IgbGeographicMap @ref="AzureAerialMap"
                   Height="100%" Width="100%" Zoomable="true"
                   BackgroundContent="@AerialImagery">
    </IgbGeographicMap>
    <IgbGeographicMap @ref="AzureRoadMap"
                   Height="100%" Width="100%" Zoomable="true"
                   BackgroundContent="@RoadImagery">
    </IgbGeographicMap>

</div>

@code {

    private IgbAzureMapsMapImagery AerialImagery;
    private IgbAzureMapsMapImagery RoadImagery;
    private IgbGeographicMap AzureAerialMap;
    private IgbGeographicMap AzureRoadMap;

    private string AzureKey = "YOURKEY";

    protected override void OnInitialized()
    {
        this.RoadImagery = CreateImagery(AzureMapsImageryStyle.Road);
        this.AerialImagery = CreateImagery(AzureMapsImageryStyle.Imagery);
    }

    public IgbAzureMapsMapImagery CreateImagery(AzureMapsImageryStyle style)
    {        
        var imagery = new IgbAzureMapsMapImagery();
        imagery.ApiKey = AzureKey;
        imagery.ImageryStyle = style;

        return imagery;
    }

    protected override void OnAfterRender(bool firstRender)
    {
        if (!firstRender)
        {
            //Task.Delay(300).ContinueWith((t) => OnZoomMap(this.AzureAerialMap));
            //Task.Delay(300).ContinueWith((t) => OnZoomMap(this.AzureRoadMap));
        }
    }

    private void OnZoomMap(IgbGeographicMap map)
    {
        var geoBounds = new Rect(-130, 15, new Size(65, 35));
        if (map != null)
            map.ZoomToGeographic(geoBounds);
    }


}